# Story 3.5: Develop Staff/Admin Dashboard Shell

## Status
Done

## Story
**As a** Staff Member, Dentist, Manager, or Admin,
**I want** an operational dashboard with navigation to internal tools,
**so that** I can access clinic management features appropriate to my role.

## Acceptance Criteria
1. Staff/Admin dashboard accessible at `/dashboard/staff` route
2. Dashboard displays welcome message with user's name and role
3. Dashboard shows user profile card (username, email, role)
4. Page uses brand three-color system ONLY: `#CEE0F3`, `#2D7C9C`, `#214491` plus white
5. Page background is pure white (`#FFFFFF`)
6. Dashboard uses Prompt font family exclusively
7. Layout includes Header with logout functionality
8. Layout includes Footer at bottom
9. Navigation menu displays tools based on user role (role-aware visibility)
10. Navigation includes placeholders for: Queue, Patients, Calendar, Treatments, Billing, Reports, Admin
11. Each nav item has Lucide React icon, label, and "Coming Soon" badge
12. Logout button clears tokens and redirects to `/login`
13. Dashboard is protected route (requires staff, dentist, manager, or admin role)
14. Page is responsive with sidebar navigation on desktop, hamburger menu on mobile
15. Active/future nav items visually distinguished (grayed out for coming soon)

## Tasks / Subtasks

- [x] **Task 1: Create StaffDashboard Component** (AC: 1, 2, 3, 4, 5, 6, 14)
  - [x] Create `frontend/src/pages/StaffDashboard.jsx`
  - [x] Set up component structure with white background
  - [x] Get user data from localStorage
  - [x] Display welcome message: "Welcome, {user.name}" with role badge
  - [x] Use Prompt font throughout
  - [x] Implement responsive layout (sidebar on desktop, mobile menu)

- [x] **Task 2: Create Profile Summary Card** (AC: 3)
  - [x] Create profile card component in dashboard
  - [x] Display user icon (User from Lucide React) in Teal Blue
  - [x] Show username, email, and role badge
  - [x] Style card with brand colors (white bg, Light Blue border)
  - [x] Format role as badge with background color based on role level

- [x] **Task 3: Create Navigation Menu with Role-Based Items** (AC: 9, 10, 11, 15)
  - [x] Define navigation items array with role requirements:
    ```javascript
    const navItems = [
      { id: 'queue', label: 'Queue Management', icon: 'List', roles: ['staff', 'dentist', 'manager', 'admin'], comingSoon: true },
      { id: 'patients', label: 'Patient Records', icon: 'Users', roles: ['staff', 'dentist', 'manager', 'admin'], comingSoon: true },
      { id: 'calendar', label: 'Calendar', icon: 'Calendar', roles: ['staff', 'dentist', 'manager', 'admin'], comingSoon: true },
      { id: 'treatments', label: 'Treatments', icon: 'Stethoscope', roles: ['dentist', 'manager', 'admin'], comingSoon: true },
      { id: 'billing', label: 'Billing', icon: 'DollarSign', roles: ['staff', 'manager', 'admin'], comingSoon: true },
      { id: 'reports', label: 'Reports', icon: 'BarChart', roles: ['manager', 'admin'], comingSoon: true },
      { id: 'admin', label: 'Admin Tools', icon: 'Settings', roles: ['admin'], comingSoon: true }
    ];
    ```
  - [x] Filter nav items based on user's role
  - [x] Display filtered items in sidebar/menu
  - [x] Add "Coming Soon" badge to placeholder items

- [x] **Task 4: Style Navigation Items** (AC: 11, 15)
  - [x] Import Lucide React icons for each nav item
  - [x] Style active/available items: Teal Blue icon, Deep Navy text
  - [x] Style coming soon items: Gray icon and text, reduced opacity
  - [x] Add "Coming Soon" pill/badge in Light Blue
  - [x] Hover state: Light Blue background for available items (none for disabled)

- [x] **Task 5: Implement Sidebar Layout (Desktop)** (AC: 14)
  - [x] Create sidebar component:
    - [x] Fixed left sidebar (width: 256px)
    - [x] White background with Light Blue right border
    - [x] Nav items stacked vertically
    - [x] Icons aligned left, labels right
  - [x] Main content area to right of sidebar
  - [x] Display only on screens >= 768px

- [x] **Task 6: Implement Mobile Menu** (AC: 14)
  - [x] Add hamburger menu icon in Header (Menu from Lucide React)
  - [x] Implement state for mobile menu open/closed
  - [x] Mobile menu slides in from left or drops down
  - [x] Click outside or X icon closes menu
  - [x] Display only on screens < 768px
  - [x] Style mobile menu with brand colors

- [x] **Task 7: Add Header with Logout** (AC: 7, 12)
  - [x] Import/update Header component
  - [x] Add logout button (visible when authenticated)
  - [x] Style logout button: Teal Blue bg, white text, hover Deep Navy
  - [x] Implement logout handler (clear localStorage, navigate to login)

- [x] **Task 8: Add Footer** (AC: 8)
  - [x] Import existing Footer component
  - [x] Ensure Footer at bottom of page
  - [x] Verify brand colors maintained

- [x] **Task 9: Update App Routing** (AC: 1, 13)
  - [x] Add `/dashboard/staff` route in `App.jsx`
  - [x] Wrap with ProtectedRoute: `allowedRoles={['staff', 'dentist', 'manager', 'admin']}`
  - [x] Import StaffDashboard component
  - [x] Add redirect from `/dashboard/admin` to `/dashboard/staff` (same dashboard for all staff roles)

- [x] **Task 10: Testing and Validation**
  - [x] **Authentication & Authorization:**
    - [x] Login as staff → redirects to `/dashboard/staff` → displays dashboard
    - [x] Login as dentist → can access dashboard
    - [x] Login as manager → can access dashboard
    - [x] Login as admin → can access dashboard
    - [x] Login as patient → cannot access → redirects to `/unauthorized`
    - [x] Access without login → redirects to `/login`
  - [x] **Role-Based Navigation:**
    - [x] Login as staff → sees Queue, Patients, Calendar, Billing (NOT Treatments, Reports, Admin)
    - [x] Login as dentist → sees Queue, Patients, Calendar, Treatments (NOT Reports, Admin)
    - [x] Login as manager → sees Queue, Patients, Calendar, Treatments, Billing, Reports (NOT Admin Tools)
    - [x] Login as admin → sees all 7 nav items
  - [x] **UI/Brand Compliance:**
    - [x] Only brand colors used (no other colors)
    - [x] White background on page
    - [x] Prompt font throughout
    - [x] Button hover states work (Teal → Deep Navy)
    - [x] Coming soon badges visible
  - [x] **Functionality:**
    - [x] Welcome message shows correct name and role
    - [x] Profile card displays user data correctly
    - [x] Logout clears localStorage and redirects
  - [x] **Responsive:**
    - [x] Desktop (>= 768px): Sidebar visible, nav items in sidebar
    - [x] Mobile (< 768px): Hamburger menu, sidebar hidden, menu opens on click
    - [x] Tablet (768px): Smooth transition between layouts

## Dev Notes

### Previous Story Context
[Source: Stories 3.1, 3.2, 3.3, 3.4 - To be completed]

Required implementations from previous stories:
- **Story 3.1:** JWT authentication, user roles in token
- **Story 3.2:** Login with role-based redirect, localStorage token storage
- **Story 3.3:** RBAC middleware, ProtectedRoute with `allowedRoles`
- **Story 3.4:** Patient dashboard pattern (Header, Footer, logout, profile card)

**Dependencies:** This story REQUIRES Stories 3.1, 3.2, 3.3, and 3.4 to be completed first.

### Technology Stack
[Source: docs/architecture/2-technology-stack.md]

**Frontend:**
- React 18.x
- React Router for routing
- Lucide React for icons
- Tailwind CSS for styling
- localStorage for user data

### Role-Based Navigation Logic
[Source: docs/prd/1-user-roles-access-hierarchy.md]

**Navigation Item Visibility by Role:**

| Feature | Staff | Dentist | Manager | Admin |
|---------|-------|---------|---------|-------|
| Queue Management | ✓ | ✓ | ✓ | ✓ |
| Patient Records | ✓ | ✓ | ✓ | ✓ |
| Calendar | ✓ | ✓ | ✓ | ✓ |
| Treatments | ✗ | ✓ | ✓ | ✓ |
| Billing | ✓ | ✗ | ✓ | ✓ |
| Reports | ✗ | ✗ | ✓ | ✓ |
| Admin Tools | ✗ | ✗ | ✗ | ✓ |

**Logic:**
```javascript
const canAccessFeature = (userRole, requiredRoles) => {
  return requiredRoles.includes(userRole);
};

// Filter nav items
const visibleNavItems = navItems.filter(item =>
  canAccessFeature(user.role, item.roles)
);
```

### Brand Compliance
[Source: docs/prd/8-uiux-specifications.md]

**Dashboard Colors:**
- Background: `#FFFFFF` (White)
- Headings: `#214491` (Deep Navy)
- Icons (active): `#2D7C9C` (Teal Blue)
- Icons (disabled): `#9CA3AF` (Gray)
- Borders: `#CEE0F3` (Light Blue)
- Coming Soon badge: `#CEE0F3` background, `#214491` text

**Sidebar Styling:**
```css
Sidebar (Desktop):
- Background: #FFFFFF
- Border-right: 1px solid #CEE0F3
- Width: 256px
- Padding: 24px 16px
```

**Nav Item (Active/Available):**
```css
- Icon: #2D7C9C (Teal Blue)
- Text: #214491 (Deep Navy)
- Font: Prompt Medium (500)
- Hover: Background #CEE0F3, opacity 0.3
```

**Nav Item (Coming Soon):**
```css
- Icon: #9CA3AF (Gray)
- Text: #9CA3AF (Gray)
- Opacity: 0.5
- Cursor: not-allowed
- No hover effect
```

### Responsive Layout Pattern
[Source: docs/architecture/3-frontend-architecture-ux-patterns.md]

**Desktop Layout (>= 768px):**
```
┌────────────────────────────────────┐
│         Header (Logout)            │
├─────────┬──────────────────────────┤
│         │                          │
│ Sidebar │   Main Content Area      │
│  (Nav)  │   (Profile, Welcome)     │
│         │                          │
├─────────┴──────────────────────────┤
│            Footer                  │
└────────────────────────────────────┘
```

**Mobile Layout (< 768px):**
```
┌────────────────────────────────────┐
│  Header (Hamburger + Logout)       │
├────────────────────────────────────┤
│                                    │
│    Main Content Area (Stacked)     │
│    (Profile, Welcome)              │
│                                    │
├────────────────────────────────────┤
│            Footer                  │
└────────────────────────────────────┘

[Hamburger clicked → Slide-in menu from left]
```

### Icon Mapping
[Source: Lucide React icon library]

**Navigation Icons:**
- Queue Management: `List` or `ClipboardList`
- Patient Records: `Users`
- Calendar: `Calendar`
- Treatments: `Stethoscope` or `Activity`
- Billing: `DollarSign` or `Receipt`
- Reports: `BarChart` or `TrendingUp`
- Admin Tools: `Settings` or `Shield`

### Logout Implementation
[Source: Story 3.4 pattern]

**Same logout logic as Patient dashboard:**
```javascript
const handleLogout = () => {
  localStorage.removeItem('accessToken');
  localStorage.removeItem('refreshToken');
  localStorage.removeItem('user');
  navigate('/login');
};
```

### File Locations
[Source: Frontend structure from Story 3.4]

**Frontend Files:**
```
frontend/src/
├── pages/
│   ├── StaffDashboard.jsx (NEW)
│   ├── PatientDashboard.jsx (from Story 3.4)
│   └── LoginPage.jsx (from Story 3.2)
├── components/
│   ├── Header.jsx (update with mobile hamburger)
│   ├── Footer.jsx (already exists)
│   ├── Sidebar.jsx (NEW - optional separate component)
│   └── ProtectedRoute.jsx (from Story 3.3)
└── App.jsx (add staff dashboard route)
```

### Testing Standards

**Manual Testing:**

1. **Role-Based Access:**
   - Each role (staff, dentist, manager, admin) can access dashboard
   - Patient role cannot access (403/unauthorized redirect)
   - Unauthenticated users redirect to login

2. **Navigation Visibility:**
   - Staff sees 5 items (Queue, Patients, Calendar, Billing, + others)
   - Dentist sees appropriate items (includes Treatments, excludes Billing)
   - Manager sees all except Admin Tools
   - Admin sees all 7 items

3. **UI/Brand Compliance:**
   - Only three brand colors + white
   - Prompt font throughout
   - Correct hover states
   - Coming soon badges visible
   - Icons in Teal Blue (active) or Gray (disabled)

4. **Responsive:**
   - Desktop: Sidebar visible on left
   - Mobile: Hamburger menu, sidebar hidden
   - Tablet: Smooth layout transition
   - No horizontal scroll

5. **Functionality:**
   - Welcome shows name and role
   - Profile card shows correct data
   - Logout works correctly
   - Mobile menu opens/closes

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-13 | 1.0 | Initial story creation for Epic 3.5 | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes List
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_
